#!/bin/execlineb -P

# temporary
/bin/s6-env -i
/bin/redirfd -w 1 /run/init-log
/bin/redirfd -w 2 /run/init-log

/bin/export PATH "/usr/bin:/bin"
/bin/cd /
s6-setsid -b --
umask 022
if { s6-echo -- "\ns6 init booting up...\n\n" }
#if { s6-mount -wt tmpfs -o mode=0755 tmpfs "/run" }
#if { s6-mount -t devtmpfs dev /dev }
if { s6-hiercopy "/etc/s6/run /run }
s6-envdir -I -- /etc/s6/env
redirfd -r 0 /dev/null
redirfd -wnb 1 /run/service/s6-svscan-log/fifo
background
{
    s6-setsid --
    redirfd -w 1 /run/service/s6-svscan-log/fifo
    # output to /dev/console
    fdmove -c 1 2
    /etc/s6/rc.init
}
unexport !
cd /run/service
fdmove -c 2 1
s6-svscan -st0
